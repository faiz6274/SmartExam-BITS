{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from \"axios\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nvar API_BASE;\nif (Platform.OS === \"android\") {\n  API_BASE = \"http://192.168.1.30:8000/api/\";\n} else if (Platform.OS === \"ios\") {\n  API_BASE = \"http://localhost:8000/api/\";\n} else {\n  API_BASE = \"http://localhost:8000/api/\";\n}\nvar api = axios.create({\n  baseURL: API_BASE,\n  timeout: 30000,\n  headers: {\n    Accept: \"application/json\",\n    \"Content-Type\": \"application/json\"\n  },\n  xsrfCookieName: \"\",\n  xsrfHeaderName: \"\"\n});\nconsole.log(\"API Base URL:\", API_BASE);\napi.interceptors.request.use(function () {\n  var _ref = _asyncToGenerator(function* (config) {\n    var publicEndpoints = [\"register/\", \"login/\", \"token/\"];\n    var isPublicEndpoint = publicEndpoints.some(function (endpoint) {\n      return config.url.includes(endpoint);\n    });\n    if (!isPublicEndpoint) {\n      var token = yield AsyncStorage.getItem(\"accessToken\");\n      if (token) config.headers.Authorization = \"Bearer \" + token;\n    }\n    console.log(\"API Request:\", config.url);\n    return config;\n  });\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\napi.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  var _error$config, _error$config2, _error$response, _error$response2, _error$response3;\n  console.log(\"API Error Details:\", {\n    message: error.message,\n    code: error.code,\n    url: (_error$config = error.config) == null ? void 0 : _error$config.url,\n    baseURL: (_error$config2 = error.config) == null ? void 0 : _error$config2.baseURL,\n    status: (_error$response = error.response) == null ? void 0 : _error$response.status,\n    statusText: (_error$response2 = error.response) == null ? void 0 : _error$response2.statusText,\n    responseData: (_error$response3 = error.response) == null ? void 0 : _error$response3.data,\n    errno: error.errno\n  });\n  return Promise.reject(error);\n});\nexport default api;\nexport var testConnection = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    try {\n      console.log(\"Testing connection to:\", API_BASE);\n      var res = yield api.get(\"\");\n      console.log(\"Connection successful:\", res.data);\n      return true;\n    } catch (e) {\n      console.error(\"Connection failed:\", e.message);\n      return false;\n    }\n  });\n  return function testConnection() {\n    return _ref2.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["axios","AsyncStorage","Platform","API_BASE","OS","api","create","baseURL","timeout","headers","Accept","xsrfCookieName","xsrfHeaderName","console","log","interceptors","request","use","_ref","_asyncToGenerator","config","publicEndpoints","isPublicEndpoint","some","endpoint","url","includes","token","getItem","Authorization","_x","apply","arguments","response","error","_error$config","_error$config2","_error$response","_error$response2","_error$response3","message","code","status","statusText","responseData","data","errno","Promise","reject","testConnection","_ref2","res","get","e"],"sources":["C:/Users/muham/Downloads/SmartExam-BITS/SmartExam_Frontend/src/api/axios.js"],"sourcesContent":["import axios from \"axios\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { Platform } from \"react-native\";\r\n\r\n// Dynamic API base URL based on platform\r\nlet API_BASE;\r\n\r\nif (Platform.OS === \"android\") {\r\n  // Android emulator - use host machine IP address\r\n  API_BASE = \"http://192.168.1.30:8000/api/\";\r\n} else if (Platform.OS === \"ios\") {\r\n  API_BASE = \"http://localhost:8000/api/\";\r\n} else {\r\n  // Fallback for web or other platforms\r\n  API_BASE = \"http://localhost:8000/api/\";\r\n}\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE,\r\n  timeout: 30000,\r\n  headers: {\r\n    Accept: \"application/json\",\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n  // Don't require CSRF token for mobile app\r\n  xsrfCookieName: \"\", // Disable CSRF cookie\r\n  xsrfHeaderName: \"\", // Disable CSRF header\r\n});\r\n\r\nconsole.log(\"API Base URL:\", API_BASE);\r\n\r\n// Attach access token to every request (except public endpoints)\r\napi.interceptors.request.use(async (config) => {\r\n  // Don't attach token to public endpoints\r\n  const publicEndpoints = [\"register/\", \"login/\", \"token/\"];\r\n  const isPublicEndpoint = publicEndpoints.some((endpoint) =>\r\n    config.url.includes(endpoint)\r\n  );\r\n\r\n  if (!isPublicEndpoint) {\r\n    const token = await AsyncStorage.getItem(\"accessToken\");\r\n    if (token) config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n\r\n  console.log(\"API Request:\", config.url);\r\n  return config;\r\n});\r\n\r\n// Log errors for debugging\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    console.log(\"API Error Details:\", {\r\n      message: error.message,\r\n      code: error.code,\r\n      url: error.config?.url,\r\n      baseURL: error.config?.baseURL,\r\n      status: error.response?.status,\r\n      statusText: error.response?.statusText,\r\n      responseData: error.response?.data,\r\n      errno: error.errno,\r\n    });\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n\r\n// Test connectivity\r\nexport const testConnection = async () => {\r\n  try {\r\n    console.log(\"Testing connection to:\", API_BASE);\r\n    const res = await api.get(\"\");\r\n    console.log(\"Connection successful:\", res.data);\r\n    return true;\r\n  } catch (e) {\r\n    console.error(\"Connection failed:\", e.message);\r\n    return false;\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}